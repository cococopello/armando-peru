<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Armando el Per√∫ con STEAM</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f9f9f9; }
    h1, h2 { text-align: center; }
    section { margin-bottom: 40px; }
    .question { background: #fff; border: 1px solid #ddd; padding: 15px; border-radius: 6px; margin-bottom: 15px; }
    .question p { margin: 0 0 10px; }
    .question label { display: block; margin: 5px 0; cursor: pointer; }
    .question button { margin-top: 10px; padding: 6px 12px; }
    .feedback { font-weight: bold; margin-top: 8px; }

    /* Mapa al 40% ancho, relaci√≥n de aspecto 1024/1536 */
    #map-container {
      position: relative;
      width: 40%;
      max-width: 400px;
      margin: 20px auto;
      background: url('mapa_base.png') no-repeat center center;
      background-size: contain;
      aspect-ratio: 1024 / 1536;
      border: 2px solid #ccc;
    }
    .drop-zone {
      position: absolute;
      border: 2px dashed #888;
      border-radius: 4px;
      overflow: hidden;
      box-sizing: border-box;
    }
    /* Zonas recalibradas */
    #drop1 { top: 10%;  left: -2%; width: 32%; height: 37%; }
    #drop2 { top: 2%;   left: 28%; width: 48%; height: 30%; }
    #drop3 { top: 28%;  left: 27%; width: 52%; height: 42%; }
    #drop4 { top: 55%;  left: 26%; width: 35%; height: 22%; }
    #drop5 { top: 38%;  left: 75%; width: 20%; height: 28%; }

    #pieces-palette { text-align: center; margin-top: 20px; }
    .piece { max-width: 18%; opacity: 0.4; cursor: not-allowed; transition: opacity 0.3s; }
    .piece.unlocked { opacity: 1; cursor: grab; }
    .drop-zone .piece {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      object-fit: contain;
      cursor: default;
    }
  </style>
</head>
<body>
  <h1>üß© Armando el Per√∫ con STEAM</h1>
  <section id="quiz">
    <!-- Quiz completo omitido para brevedad, mismo que antes -->
  </section>

  <section id="map">
    <h2>üó∫Ô∏è Mapa de Per√∫</h2>
    <div id="map-container">
      <div id="drop1" class="drop-zone" data-piece="1"></div>
      <div id="drop2" class="drop-zone" data-piece="2"></div>
      <div id="drop3" class="drop-zone" data-piece="3"></div>
      <div id="drop4" class="drop-zone" data-piece="4"></div>
      <div id="drop5" class="drop-zone" data-piece="5"></div>
    </div>
    <div id="pieces-palette">
      <img id="piece1" class="piece" data-piece="1" src="pieces/pieza1.png" draggable="false">
      <img id="piece2" class="piece" data-piece="2" src="pieces/pieza2.png" draggable="false">
      <img id="piece3" class="piece" data-piece="3" src="pieces/pieza3.png" draggable="false">
      <img id="piece4" class="piece" data-piece="4" src="pieces/pieza4.png" draggable="false">
      <img id="piece5" class="piece" data-piece="5" src="pieces/pieza5.png" draggable="false">
    </div>
  </section>

  <script>
    // Inicializa botones de respuestas
    document.querySelectorAll('.btn').forEach(btn => {
      btn.addEventListener('click', () => checkAnswer(btn.dataset.question));
    });
    function checkAnswer(n) {
      const container = document.querySelector(`.question[data-question="${n}"]`);
      const selected = container.querySelector(`input[name="q${n}"]:checked`);
      const fb = container.querySelector('.feedback');
      if (!selected) return fb.textContent='Selecciona una opci√≥n.', fb.style.color='red';
      if (selected.value===container.dataset.correct) {
        fb.textContent=`¬°Correcto! Arrastra la pieza ${n}.`;
        fb.style.color='green'; unlockPiece(n);
      } else fb.textContent='Incorrecto. Intenta de nuevo.', fb.style.color='red';
    }
    // Drag & Drop
    document.querySelectorAll('.drop-zone').forEach(z=>{z.addEventListener('dragover',e=>e.preventDefault());z.addEventListener('drop',handleDrop);});
    function unlockPiece(n){const p=document.querySelector(`.piece[data-piece="${n}"]`);if(!p.classList.contains('unlocked')){p.draggable=true;p.classList.add('unlocked');p.addEventListener('dragstart',e=>e.dataTransfer.setData('text/plain',n));}}
    function handleDrop(e){e.preventDefault();const z=e.currentTarget,id=e.dataTransfer.getData('text/plain');if(z.dataset.piece!==id){alert('Pieza incorrecta');return;}z.appendChild(document.querySelector(`.piece[data-piece="${id}"]`));updateProgress();}
    function updateProgress(){if(document.querySelectorAll('.drop-zone>.piece').length===5)setTimeout(()=>alert('¬°Mapa completo!'),100);}
  </script>
</body>
</html>
